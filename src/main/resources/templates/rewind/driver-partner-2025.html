<!doctype html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="format-detection" content="telephone=no,date=no,address=no,email=no"/>
  <meta name="robots" content="noindex,nofollow"/>
  <title>Nh√¨n l·∫°i Grab 2025</title>
  <style>
    :root{
      /* Light theme (Mex-style) */
      --bg0:#D9FCDE;  /* Softest green */
      --bg1:#EBFAFF;  /* Softest blue */
      --bg2:#FBF0FF;  /* Softest purple */
      --card:rgba(255,255,255,.92);
      --card2:rgba(255,255,255,.78);
      --text:#184440;   /* deep green/ink */
      --muted:rgba(24,68,64,.74);
      --muted2:rgba(24,68,64,.58);
      --line:rgba(0,177,79,.20);
      /* Brand palette (primary) */
      --accent:#00B14F;         /* Default */
      --accent-600:#00804A;     /* Bolder */
      --accent-700:#005339;     /* Boldest */
      --accent-soft:#B1EABA;    /* Soft */
      --accent-softest:#D9FCDE; /* Softest */
      --accent2:#FFD933;        /* Yellow default */
      --accent2-soft:#FFEC8F;   /* Yellow soft */
      --danger:#D42E1C;         /* Red default */
      /* Extra palette (from submitted chart) */
      --lime:#D3F035;
      --orange:#F76708;
      --teal:#17B5A6;
      --blue:#136FD8;
      --purple:#D194FF;
      --shadow: 0 14px 40px rgba(24,68,64,.10);
      --radius: 18px;
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-right: env(safe-area-inset-right, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --safe-left: env(safe-area-inset-left, 0px);
      --font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--font);
      color: var(--text);
      /* Bright background using submitted palette (Mex-style) */
      background:
        radial-gradient(980px 760px at 14% 16%, rgba(0,177,79,.22), transparent 62%),
        radial-gradient(920px 720px at 86% 18%, rgba(255,217,51,.20), transparent 64%),
        radial-gradient(900px 700px at 82% 78%, rgba(23,181,166,.18), transparent 64%),
        radial-gradient(900px 700px at 34% 88%, rgba(209,148,255,.16), transparent 66%),
        radial-gradient(820px 640px at 60% 58%, rgba(19,111,216,.12), transparent 70%),
        linear-gradient(180deg, var(--bg0) 0%, var(--bg1) 56%, var(--bg2) 100%);
      overflow:hidden;
    }
    .wrap{
      height:100%;
      padding: calc(12px + var(--safe-top)) calc(14px + var(--safe-right)) calc(14px + var(--safe-bottom)) calc(14px + var(--safe-left));
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .topbar{ display:flex; flex-direction:column; gap:10px; }
    .meta{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.78);
      border:1px solid rgba(0,177,79,.22);
    }
    .dot{
      width:8px; height:8px; border-radius:50%;
      background: var(--accent);
      box-shadow: 0 0 0 6px rgba(0,177,79,.18);
    }
    .brand{ font-weight: 800; letter-spacing: .2px; font-size: 13px; color: var(--accent-700); }
    .hint{ font-size: 12px; color: var(--muted2); user-select:none; white-space:nowrap; }
    .stage{
      position:relative;
      flex:1;
      border-radius: calc(var(--radius) + 8px);
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.88));
      border: 2px solid rgba(0,177,79,.26);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
    }
    .bgfx{
      position:absolute; inset:-2px;
      background:
        radial-gradient(620px 420px at 10% 18%, rgba(0,177,79,.18), transparent 62%),
        radial-gradient(600px 420px at 92% 22%, rgba(255,217,51,.16), transparent 64%),
        radial-gradient(620px 520px at 82% 110%, rgba(23,181,166,.14), transparent 66%),
        radial-gradient(620px 520px at 42% 118%, rgba(209,148,255,.12), transparent 70%);
      filter: saturate(1.2);
      opacity: .85;
      pointer-events:none;
    }
    .slidesWrap{
      position:relative;
      width:100%;
      height:100%;
      flex: 1 1 auto;
      overflow-x:auto;
      overflow-y:hidden;
      -webkit-overflow-scrolling: touch;
      scroll-snap-type: x mandatory;
    }
    .slidesWrap::-webkit-scrollbar{ display:none; }
    .slidesWrap{ scrollbar-width: none; }
    .slides{
      position:relative;
      height:100%;
      display:flex;
      min-width: 100%;
    }
    .slide{
      scroll-snap-align: start;
      flex: 0 0 100%;
      width: 100%;
      height: 100%;
      padding: 22px 18px;
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      gap:14px;
    }
    .kicker{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:7px 10px;
      border-radius: 999px;
      background: rgba(255,249,192,.92);
      border: 1px solid rgba(255,217,51,.45);
      color: rgba(24,68,64,.92);
      font-size: 12px;
      letter-spacing:.2px;
    }
    .tag b{ color: var(--accent-600); }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:7px 10px;
      border-radius: 999px;
      background: rgba(217,252,222,.75);
      border: 1px solid rgba(0,177,79,.24);
      font-size: 12px;
      color: rgba(24,68,64,.88);
    }
    .title{ font-size: 26px; line-height: 1.15; margin:0; letter-spacing: -0.2px; }
    .title strong{ color: var(--accent-700); }
    .sub{ margin:0; font-size: 14px; line-height:1.5; color: var(--muted); white-space: pre-line; }
    .stat{
      padding: 14px 14px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.90));
      border:1px solid rgba(0,177,79,.22);
    }
    .stat .label{ font-size: 12px; letter-spacing:.3px; text-transform: uppercase; color: var(--muted2); }
    .stat .value{ margin-top:8px; font-size: 34px; line-height: 1.1; font-weight: 800; letter-spacing: -0.6px; }
    .value .hl{ color: var(--accent); }
    .value .hl2{ color: var(--accent2); }

    /* Compact multi stats (3 rows) */
    .multiStat{
      margin-top: 8px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .msRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      padding: 10px 10px;
      border-radius: 14px;
      background: rgba(217,252,222,.60);
      border: 1px solid rgba(0,177,79,.18);
    }
    .msLeft{
      display:flex;
      flex-direction:column;
      gap:2px;
      min-width: 0;
    }
    .msName{
      font-size: 12px;
      font-weight: 800;
      color: rgba(24,68,64,.92);
      letter-spacing:.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .msDesc{
      font-size: 12px;
      line-height: 1.35;
      color: rgba(24,68,64,.72);
    }
    .msVal{
      flex: 0 0 auto;
      font-size: 20px;
      line-height: 1.1;
      font-weight: 900;
      letter-spacing: -0.3px;
      color: var(--accent-700);
      white-space:nowrap;
    }
    .msVal i{
      font-style: normal;
      color: var(--accent);
    }

    /* Persona (special) */
    .stage.is-persona{
      border-color: rgba(0,177,79,.34);
      box-shadow: 0 18px 52px rgba(0,177,79,.14), var(--shadow);
    }
    .stage.is-persona .bgfx{
      background:
        radial-gradient(760px 520px at 16% 18%, rgba(0,177,79,.22), transparent 62%),
        radial-gradient(720px 520px at 88% 22%, rgba(255,217,51,.18), transparent 66%),
        radial-gradient(820px 620px at 55% 118%, rgba(23,181,166,.14), transparent 70%);
      opacity: 1;
    }
    .personaWrap{
      position: relative;
      padding: 14px 14px 12px;
      border-radius: 16px;
      background:
        radial-gradient(420px 220px at 16% 0%, rgba(0,177,79,.14), transparent 62%),
        radial-gradient(420px 220px at 92% 10%, rgba(255,217,51,.14), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.98), rgba(255,255,255,.92));
      border: 1px solid rgba(0,177,79,.22);
      box-shadow: 0 14px 34px rgba(24,68,64,.10);
      overflow: hidden;
    }
    .personaWrap:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(240px 240px at 10% 20%, rgba(0,177,79,.18), transparent 60%),
        radial-gradient(220px 220px at 95% 35%, rgba(255,217,51,.14), transparent 62%);
      pointer-events:none;
      opacity:.95;
    }
    .personaTop{
      position: relative;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom: 10px;
    }
    .personaSeal{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(0,177,79,1);
      border: 1px solid rgba(0,128,74,.30);
      color: #fff;
      font-size: 12px;
      font-weight: 800;
      letter-spacing:.2px;
    }
    .personaSeal i{
      width: 18px;
      height: 18px;
      display:inline-grid;
      place-items:center;
      border-radius: 50%;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.12);
      font-style: normal;
    }
    .personaChip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(255,249,192,.95);
      border: 1px solid rgba(255,217,51,.40);
      color: rgba(24,68,64,.86);
      font-size: 12px;
      white-space:nowrap;
    }
    .personaName{
      position: relative;
      font-size: 34px;
      line-height: 1.05;
      font-weight: 900;
      letter-spacing: -0.8px;
      margin: 2px 0 8px;
      color: rgba(24,68,64,.98);
      text-shadow: 0 14px 34px rgba(0,177,79,.12);
    }
    .personaName .g{
      color: var(--accent);
    }
    .personaLine{
      position: relative;
      font-size: 13px;
      line-height: 1.45;
      color: rgba(24,68,64,.82);
    }
    .personaLine b{ color: var(--accent2); }
    .foot{ display:flex; align-items:flex-end; justify-content:space-between; gap:12px; margin-top: 6px; }
    .note{ font-size: 12px; color: var(--muted2); line-height:1.35; max-width: 80%; }
    .cta{
      font-size: 12px;
      font-weight: 700;
      color: #fff;
      padding:10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(0,128,74,.20);
      background: linear-gradient(180deg, rgba(0,177,79,1), rgba(0,128,74,1));
      user-select:none;
      white-space:nowrap;
    }
  </style>
</head>
<body>
<div class="wrap">
  <div class="topbar">
    <div class="meta">
      <div class="pill" aria-label="D·ª± √°n">
        <span class="dot" aria-hidden="true"></span>
        <span class="brand">Nh√¨n l·∫°i Grab 2025</span>
      </div>
      <div class="hint">Vu·ªët ngang ƒë·ªÉ xem ti·∫øp</div>
    </div>
  </div>

  <div class="stage" role="group" aria-label="Nh√¨n l·∫°i Grab 2025">
    <div class="bgfx" aria-hidden="true"></div>
    <div class="slidesWrap" aria-label="Vu·ªët ngang ƒë·ªÉ xem c√°c m·ª•c">
      <div class="slides">
        <section class="slide">
          <div class="kicker">
            <span class="tag"><span aria-hidden="true">‚ú¶</span> <b>M·ªü ƒë·∫ßu</b></span>
            <span class="badge">2025</span>
          </div>
          <div>
            <h1 class="title">ƒê·ªëi t√°c <strong th:text="${driverName}">ƒê·ªëi t√°c</strong> th√¢n m·∫øn üíö</h1>
            <p class="sub">
              NƒÉm 2025 v·ª´a kh√©p l·∫°i, ƒê·ªëi t√°c c√≥ t√≤ m√≤ r·∫±ng b·∫£n th√¢n ƒë√£ ho·∫°t ƒë·ªông nh∆∞ th·∫ø n√†o trong nƒÉm qua kh√¥ng? H√£y c√πng Grab nh√¨n l·∫°i t·∫°i ƒë√¢y nh√©:

              üëâ S·ªë l∆∞·ª£ng chuy·∫øn xe ƒê·ªëi t√°c ho√†n th√†nh theo lo·∫°i d·ªãch v·ª•:
            </p>
          </div>
          <div class="foot">
            <div class="note">Vu·ªët ngang ƒë·ªÉ xem ti·∫øp.</div>
            <div class="cta">Ti·∫øp</div>
          </div>
        </section>

        <section class="slide">
          <div class="kicker">
            <span class="tag"><span aria-hidden="true">‚ú¶</span> <b>T·ªïng s·ªë cu·ªëc xe c·ªßa t·ª´ng d·ªãch v·ª• trong nƒÉm qua</b></span>
            <span class="badge">2025</span>
          </div>
          <div>
            <h1 class="title">S·ªë l∆∞·ª£ng chuy·∫øn xe theo d·ªãch v·ª•</h1>
            <p class="sub">M·ªôt nƒÉm b·ªÅn b·ªâ v·ªõi nhi·ªÅu vai tr√≤ kh√°c nhau. Trong nƒÉm 2025, ƒê·ªëi t√°c ƒë√£ ho√†n th√†nh:</p>
          </div>
          <div class="stat">
            <div class="label">T·ªïng quan chuy·∫øn xe</div>
            <div class="value" style="font-size: 20px; letter-spacing: 0; font-weight: 800;">
              <div class="multiStat">
                <div class="msRow">
                  <div class="msLeft">
                    <div class="msName">GrabBike üõµ</div>
                    <div class="msDesc">Gi√∫p nhi·ªÅu H√†nh kh√°ch ‚Äúƒëi ƒë·∫øn n∆°i, v·ªÅ ƒë·∫øn ch·ªën‚Äù.</div>
                  </div>
                  <div class="msVal"><i th:text="${totalGbRides}">0</i> chuy·∫øn</div>
                </div>
                <div class="msRow" style="background: rgba(255,249,192,.85); border-color: rgba(255,217,51,.35)">
                  <div class="msLeft">
                    <div class="msName">GrabFood & GrabMart üçúüõí</div>
                    <div class="msDesc">Gi√∫p nhi·ªÅu Ng∆∞·ªùi d√πng nh·∫≠n nh·ªØng b·ªØa ƒÉn v·∫πn tr√≤n, m√≥n h√†ng thi·∫øt y·∫øu.</div>
                  </div>
                  <div class="msVal"><i th:text="${totalGfmRides}">0</i> chuy·∫øn</div>
                </div>
                <div class="msRow" style="background: rgba(235,250,255,.92); border-color: rgba(19,111,216,.18)">
                  <div class="msLeft">
                    <div class="msName">GrabExpress üì¶</div>
                    <div class="msDesc">ƒê·ªÉ Ng∆∞·ªùi d√πng nh·∫≠n t·∫≠n tay nh·ªØng ki·ªán h√†ng k·ªãp th·ªùi v√† ƒë√∫ng l√∫c.</div>
                  </div>
                  <div class="msVal"><i th:text="${totalGeRides}">0</i> chuy·∫øn</div>
                </div>
              </div>
            </div>
          </div>
          <div class="foot">
            <div class="note"></div>
            <div class="cta">Ti·∫øp</div>
          </div>
        </section>

        <section class="slide">
          <div class="kicker">
            <span class="tag"><span aria-hidden="true">‚ú¶</span> <b>ƒê·ªëi t√°c ƒë√≠ch th·ªã l√†‚Ä¶</b></span>
            <span class="badge">2025</span>
          </div>
          <div>
            <h1 class="title">V·ªõi t·∫ßn su·∫•t v·∫≠n h√†nh nh∆∞ v·∫≠y, ƒë√≠ch th·ªã ƒê·ªëi t√°c ch√≠nh l√†:</h1>
          </div>
          <div class="stat">
            <div class="label">DANH HI·ªÜU</div>
            <div class="value" style="font-size: 18px; letter-spacing: 0;">
              <div class="personaWrap">
                <div class="personaTop">
                  <span class="personaSeal"><i>‚úì</i> ƒê·ªëi t√°c T√†i x·∫ø Grab</span>
                  <span class="personaChip">üèÅ An to√†n l√† s·ªë 1</span>
                </div>
                <div class="personaName"><span class="g">ƒê·∫°i s·ª©</span> an to√†n</div>
                <div class="personaLine">v√¨ mang l·∫°i s·ª± an t√¢m <b>tr√™n m·ªçi n·∫ªo ƒë∆∞·ªùng</b></div>
              </div>
            </div>
          </div>
          <div class="foot">
            <div class="note"></div>
            <div class="cta">Ti·∫øp</div>
          </div>
        </section>

        <section class="slide">
          <div class="kicker">
            <span class="tag"><span aria-hidden="true">‚ú¶</span> <b>Th√†nh t√≠ch n·ªïi b·∫≠t</b></span>
            <span class="badge">2025</span>
          </div>
          <div>
            <h1 class="title">Ngo√†i ra, ƒê·ªëi t√°c ƒë√£ ‚Äúthu ho·∫°ch‚Äù ƒë∆∞·ª£c:</h1>
            <p class="sub">5 ‚≠ê & huy hi·ªáu</p>
          </div>
          <div class="stat">
            <div class="label">ƒêi·ªÉm n·ªïi b·∫≠t</div>
            <div class="value" style="font-size: 20px; letter-spacing: 0; font-weight: 800;">
              <div class="multiStat">
                <div class="msRow">
                  <div class="msLeft">
                    <div class="msName">ƒê√°nh gi√° 5 sao</div>
                    <div class="msDesc">
                      chi·∫øm <span class="hl" th:text="${pct5StarsReviews}">0%</span> tr√™n t·ªïng s·ªë l∆∞·ª£ng ƒë√°nh gi√° 5 sao m√† ƒê·ªëi t√°c ƒë√£ nh·∫≠n ƒë∆∞·ª£c t·ª´ Ng∆∞·ªùi d√πng.
                    </div>
                  </div>
                  <div class="msVal"><i th:text="${total5StarsReviews}">0</i></div>
                </div>
                <div class="msRow" style="background: rgba(255,255,255,.96)">
                  <div class="msLeft">
                    <div class="msName">Huy hi·ªáu nh·∫≠n nhi·ªÅu nh·∫•t</div>
                    <div class="msDesc">Trong ƒë√≥, <b th:text="${badgeTop1}">Huy hi·ªáu</b> l√† lo·∫°i huy hi·ªáu ƒê·ªëi t√°c nh·∫≠n ƒë∆∞·ª£c nhi·ªÅu nh·∫•t.</div>
                  </div>
                  <div class="msVal"><i th:text="${badgeTop1}">Huy hi·ªáu</i></div>
                </div>
              </div>
            </div>
          </div>
          <div class="foot">
            <div class="note">Gi·ªØ phong ƒë·ªô n√†y ƒë·ªÉ 2026 c√≤n b·ª©t t·ªëc h∆°n nh√©!</div>
            <div class="cta">Ti·∫øp</div>
          </div>
        </section>

        <section class="slide">
          <div class="kicker">
            <span class="tag"><span aria-hidden="true">‚ú¶</span> <b>Quan tr·ªçng</b></span>
            <span class="badge">2025</span>
          </div>
          <div>
            <h1 class="title">T·ª∑ l·ªá h·ªßy chuy·∫øn</h1>
          </div>
          <div class="stat">
            <div class="label">T·ª∑ l·ªá h·ªßy chuy·∫øn trung b√¨nh trong nƒÉm 2025 c·ªßa ƒê·ªëi t√°c l√†</div>
            <div class="value"><span class="hl" th:text="${averageCr}">0%</span></div>
          </div>
          <div class="foot">
            <div class="note">H√£y ti·∫øp t·ª•c c·∫£i thi·ªán t·ª∑ l·ªá nh·∫≠n n√†y ƒë·ªÉ nh·∫≠n th√™m nhi·ªÅu c∆° h·ªôi gia tƒÉng thu nh·∫≠p trong nƒÉm 2026!</div>
            <div class="cta">Ti·∫øp</div>
          </div>
        </section>

        <section class="slide">
          <div class="kicker">
            <span class="tag"><span aria-hidden="true">‚ú¶</span> <b>K·∫øt</b></span>
            <span class="badge">2025</span>
          </div>
          <div>
            <h1 class="title">C·∫£m ∆°n ƒê·ªëi t√°c <strong th:text="${driverName}">ƒê·ªëi t√°c</strong> üíö</h1>
            <p class="sub">
              H√£y d√†nh l·ªùi c√°m ∆°n ƒë·∫øn b·∫£n th√¢n v√¨ ƒë√£ kh√¥ng ng·ª´ng c·ªë g·∫Øng trong nƒÉm 2025. Gi·ªù th√¨ h√£y chia s·∫ª th√†nh t√≠ch n√†y ƒë·∫øn c√°c ‚Äúchi·∫øn h·ªØu‚Äù Grab nh√©!

              M·∫øn ch√∫c ƒê·ªëi t√°c lu√¥n ho·∫°t ƒë·ªông hi·ªáu qu·∫£ v√† an to√†n tr√™n m·ªçi n·∫ªo ƒë∆∞·ªùng üíö

              Tr√¢n tr·ªçng,
              ƒê·ªôi ng≈© Grab
            </p>
          </div>
          <div class="stat">
            <div class="label">NH·∫§N V√ÄO ƒê√ÇY ƒê·ªÇ LAN T·ªéA CHI·∫æN T√çCH C√ôNG ƒê·ªíNG ƒê·ªòI</div>
            <div class="value" style="font-size: 20px; letter-spacing: 0;">
              <span class="hl2">KHOE CHI·∫æN T√çCH NGAY</span>
            </div>
          </div>
          <div class="foot">
            <div class="note"></div>
            <div class="cta">Ho√†n th√†nh</div>
          </div>
        </section>
      </div>
    </div>
  </div>
</div>

<script th:inline="javascript">
  (function () {
    "use strict";
    // Disabled: this page is now horizontal-scroll text only (Android-safe).
    return;

    // Show JS errors early (helps Android webview debugging)
    window.onerror = function (msg, url, line, col) {
      try {
        var t = document.getElementById("toast");
        var tt = document.getElementById("toastText");
        if (tt) tt.textContent = "L·ªói: " + String(msg || "Unknown") + " @" + String(line || 0) + ":" + String(col || 0);
        if (t && t.classList) t.classList.add("show");
      } catch (e) { /* ignore */ }
      return false;
    };

    // ===== Compatibility (older Android WebView / iOS WKWebView) =====
    if (!Date.now) Date.now = function () { return new Date().getTime(); };
    if (!window.requestAnimationFrame) {
      window.requestAnimationFrame = function (cb) {
        return window.setTimeout(function () { cb(Date.now()); }, 16);
      };
    }

    // Always avoid options objects for max compatibility
    var OPT_PASSIVE_TRUE = false;
    var OPT_PASSIVE_FALSE = false;

    function addEvt(el, type, handler, options) {
      if (!el) return;
      try {
        el.addEventListener(type, handler, options);
      } catch (e) {
        // Fallback for browsers that don't accept options object
        try {
          el.addEventListener(type, handler, false);
        } catch (e2) {
          el["on" + type] = handler;
        }
      }
    }

    function prevent(e) {
      e = e || window.event;
      if (!e) return;
      if (e.preventDefault) e.preventDefault();
      e.returnValue = false;
    }

    function trimStr(s) { return String(s).replace(/^\s+|\s+$/g, ""); }

    function toggleClass(el, cls, on) {
      if (!el) return;
      if (el.classList && el.classList.add) {
        if (on) el.classList.add(cls);
        else el.classList.remove(cls);
        return;
      }
      var cur = " " + (el.className || "") + " ";
      var has = cur.indexOf(" " + cls + " ") > -1;
      if (on && !has) el.className = trimStr((el.className ? el.className + " " : "") + cls);
      if (!on && has) el.className = trimStr(cur.replace(" " + cls + " ", " "));
    }

    var SLIDE_DURATION_MS = 6000;
    var HOLD_TO_PAUSE = true;

    // Data from server (safe defaults are set in controller)
    var DATA = {
      driver_name: /*[[${driverName}]]*/ "ƒê·ªëi t√°c",
      total_gbrides: /*[[${totalGbRides}]]*/ "0",
      total_gfmrides: /*[[${totalGfmRides}]]*/ "0",
      total_gerides: /*[[${totalGeRides}]]*/ "0",
      total_5starsreviews: /*[[${total5StarsReviews}]]*/ "0",
      pct_5starsreviews: /*[[${pct5StarsReviews}]]*/ "0%",
      "%_5starsreviewsreview": /*[[${pct5StarsReviews}]]*/ "0%",
      badget_top1: /*[[${badgeTop1}]]*/ "Huy hi·ªáu",
      average_cr: /*[[${averageCr}]]*/ "0%"
    };

    function escapeHtml(str) {
      return String(str == null ? "" : str)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#39;");
    }

    function tpl(html) {
      return String(html).replace(/\{\{\s*([^}]+?)\s*\}\}/g, function (_, key) {
        var k = String(key || "").trim();
        return escapeHtml(Object.prototype.hasOwnProperty.call(DATA, k) ? DATA[k] : "");
      });
    }

    // Slides content based on the text you provided
    var slides = [
      {
        key: "intro",
        tag: "M·ªü ƒë·∫ßu",
        title: "ƒê·ªëi t√°c <strong>{{driver_name}}</strong> th√¢n m·∫øn üíö",
        body:
          "NƒÉm 2025 v·ª´a kh√©p l·∫°i, ƒê·ªëi t√°c c√≥ t√≤ m√≤ r·∫±ng b·∫£n th√¢n ƒë√£ ho·∫°t ƒë·ªông nh∆∞ th·∫ø n√†o trong nƒÉm qua kh√¥ng? H√£y c√πng Grab nh√¨n l·∫°i t·∫°i ƒë√¢y nh√©:\n\nüëâ S·ªë l∆∞·ª£ng chuy·∫øn xe ƒê·ªëi t√°c ho√†n th√†nh theo lo·∫°i d·ªãch v·ª•:",
        statLabel: null,
        statValue: null,
        note: "Tip: Ch·∫°m b√™n ph·∫£i ƒë·ªÉ xem ti·∫øp, b√™n tr√°i ƒë·ªÉ quay l·∫°i.",
        cta: "B·∫Øt ƒë·∫ßu"
      },
      {
        key: "rides",
        tag: "T·ªïng s·ªë cu·ªëc xe c·ªßa t·ª´ng d·ªãch v·ª• trong nƒÉm qua",
        title: "S·ªë l∆∞·ª£ng chuy·∫øn xe theo d·ªãch v·ª•",
        body: "M·ªôt nƒÉm b·ªÅn b·ªâ v·ªõi nhi·ªÅu vai tr√≤ kh√°c nhau. Trong nƒÉm 2025, ƒê·ªëi t√°c ƒë√£ ho√†n th√†nh:",
        statLabel: "T·ªïng quan chuy·∫øn xe",
        statValue:
          "<div class='multiStat'>" +
            "<div class='msRow'>" +
              "<div class='msLeft'>" +
                "<div class='msName'>GrabBike üõµ</div>" +
                "<div class='msDesc'>Gi√∫p nhi·ªÅu H√†nh kh√°ch ‚Äúƒëi ƒë·∫øn n∆°i, v·ªÅ ƒë·∫øn ch·ªën‚Äù.</div>" +
              "</div>" +
              "<div class='msVal'><i>" + "{{total_gbrides}}" + "</i> chuy·∫øn</div>" +
            "</div>" +
            "<div class='msRow' style='background: rgba(255,249,192,.85); border-color: rgba(255,217,51,.35)'>" +
              "<div class='msLeft'>" +
                "<div class='msName'>GrabFood & GrabMart üçúüõí</div>" +
                "<div class='msDesc'>Gi√∫p nhi·ªÅu Ng∆∞·ªùi d√πng nh·∫≠n nh·ªØng b·ªØa ƒÉn v·∫πn tr√≤n, m√≥n h√†ng thi·∫øt y·∫øu.</div>" +
              "</div>" +
              "<div class='msVal'><i>" + "{{total_gfmrides}}" + "</i> chuy·∫øn</div>" +
            "</div>" +
            "<div class='msRow' style='background: rgba(235,250,255,.92); border-color: rgba(19,111,216,.18)'>" +
              "<div class='msLeft'>" +
                "<div class='msName'>GrabExpress üì¶</div>" +
                "<div class='msDesc'>ƒê·ªÉ Ng∆∞·ªùi d√πng nh·∫≠n t·∫≠n tay nh·ªØng ki·ªán h√†ng k·ªãp th·ªùi v√† ƒë√∫ng l√∫c.</div>" +
              "</div>" +
              "<div class='msVal'><i>" + "{{total_gerides}}" + "</i> chuy·∫øn</div>" +
            "</div>" +
          "</div>",
        note: "",
        cta: "Ti·∫øp"
      },
      {
        key: "persona",
        tag: "ƒê·ªëi t√°c ƒë√≠ch th·ªã l√†‚Ä¶",
        title: "V·ªõi t·∫ßn su·∫•t v·∫≠n h√†nh nh∆∞ v·∫≠y, ƒë√≠ch th·ªã ƒê·ªëi t√°c ch√≠nh l√†:",
        body: "",
        statLabel: "DANH HI·ªÜU",
        statValue:
          "<div class='personaWrap'>" +
            "<div class='personaTop'>" +
              "<span class='personaSeal'><i>‚úì</i> ƒê·ªëi t√°c T√†i x·∫ø Grab</span>" +
              "<span class='personaChip'>üèÅ An to√†n l√† s·ªë 1</span>" +
            "</div>" +
            "<div class='personaName'><span class='g'>ƒê·∫°i s·ª©</span> an to√†n</div>" +
            "<div class='personaLine'>v√¨ mang l·∫°i s·ª± an t√¢m <b>tr√™n m·ªçi n·∫ªo ƒë∆∞·ªùng</b></div>" +
          "</div>",
        note: "",
        cta: "Ti·∫øp"
      },
      {
        key: "rating_badge",
        tag: "Th√†nh t√≠ch n·ªïi b·∫≠t",
        title: "Ngo√†i ra, ƒê·ªëi t√°c ƒë√£ ‚Äúthu ho·∫°ch‚Äù ƒë∆∞·ª£c:",
        body: "5 ‚≠ê & huy hi·ªáu",
        statLabel: "ƒêi·ªÉm n·ªïi b·∫≠t",
        statValue:
          "<div class='multiStat'>" +
            "<div class='msRow'>" +
              "<div class='msLeft'>" +
                "<div class='msName'>ƒê√°nh gi√° 5 sao</div>" +
                "<div class='msDesc'>chi·∫øm {{%_5starsreviewsreview}} tr√™n t·ªïng s·ªë l∆∞·ª£t ƒë√°nh gi√° 5 sao.</div>" +
              "</div>" +
              "<div class='msVal'><i>" + "{{total_5starsreviews}}" + "</i></div>" +
            "</div>" +
            "<div class='msRow' style='background: rgba(255,255,255,.96)'>" +
              "<div class='msLeft'>" +
                "<div class='msName'>Huy hi·ªáu nh·∫≠n nhi·ªÅu nh·∫•t</div>" +
                "<div class='msDesc'>ƒê√¢y l√† lo·∫°i huy hi·ªáu ƒê·ªëi t√°c nh·∫≠n ƒë∆∞·ª£c nhi·ªÅu nh·∫•t trong nƒÉm.</div>" +
              "</div>" +
              "<div class='msVal'><i>" + "{{badget_top1}}" + "</i></div>" +
            "</div>" +
          "</div>",
        note: "Gi·ªØ phong ƒë·ªô n√†y ƒë·ªÉ 2026 c√≤n b·ª©t t·ªëc h∆°n nh√©!",
        cta: "Ti·∫øp"
      },
      {
        key: "cr",
        tag: "Quan tr·ªçng",
        title: "T·ª∑ l·ªá h·ªßy chuy·∫øn",
        body: "",
        statLabel: "T·ª∑ l·ªá h·ªßy chuy·∫øn trung b√¨nh trong nƒÉm 2025 c·ªßa ƒê·ªëi t√°c l√†",
        statValue: "<span class='hl'>{{average_cr}}</span>",
        note: "H√£y ti·∫øp t·ª•c c·∫£i thi·ªán t·ª∑ l·ªá nh·∫≠n n√†y ƒë·ªÉ nh·∫≠n th√™m nhi·ªÅu c∆° h·ªôi gia tƒÉng thu nh·∫≠p trong nƒÉm 2026!",
        cta: "Ti·∫øp"
      },
      {
        key: "end",
        tag: "K·∫øt",
        title: "C·∫£m ∆°n ƒê·ªëi t√°c <strong>{{driver_name}}</strong> üíö",
        body:
          "H√£y d√†nh l·ªùi c√°m ∆°n ƒë·∫øn b·∫£n th√¢n v√¨ ƒë√£ kh√¥ng ng·ª´ng c·ªë g·∫Øng trong nƒÉm 2025. Gi·ªù th√¨ h√£y chia s·∫ª th√†nh t√≠ch n√†y ƒë·∫øn c√°c ‚Äúchi·∫øn h·ªØu‚Äù Grab nh√©!\n\nM·∫øn ch√∫c ƒê·ªëi t√°c lu√¥n ho·∫°t ƒë·ªông hi·ªáu qu·∫£ v√† an to√†n tr√™n m·ªçi n·∫ªo ƒë∆∞·ªùng üíö\n\nTr√¢n tr·ªçng,\nƒê·ªôi ng≈© Grab",
        statLabel: "NH·∫§N V√ÄO ƒê√ÇY ƒê·ªÇ LAN T·ªéA CHI·∫æN T√çCH C√ôNG ƒê·ªíNG ƒê·ªòI",
        statValue: "<span class='hl2'>KHOE CHI·∫æN T√çCH NGAY</span>",
        note: "",
        cta: "Ho√†n th√†nh"
      }
    ];

    // ===== State =====
    var idx = 0;
    var startedAt = Date.now();
    var paused = false;
    var pauseStartedAt = 0;
    var pausedAccum = 0;
    var rafId = 0;
    var toastT = 0;

    // ===== DOM =====
    var elProgress = document.getElementById("progress");
    var elContent = document.getElementById("content");
    var elStage = document.getElementById("stage");
    var elPrev = document.getElementById("zonePrev");
    var elNext = document.getElementById("zoneNext");
    var elToast = document.getElementById("toast");
    var elToastText = document.getElementById("toastText");

    // Build progress segments
    var segEls = [];
    (function buildProgress() {
      elProgress.innerHTML = "";
      segEls = [];
      for (var i = 0; i < slides.length; i++) {
        var seg = document.createElement("div");
        seg.className = "seg";
        var fill = document.createElement("i");
        seg.appendChild(fill);
        elProgress.appendChild(seg);
        segEls.push(fill);
      }
    })();

    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

    function showToast(msg) {
      window.clearTimeout(toastT);
      elToastText.textContent = msg;
      elToast.classList.add("show");
      toastT = window.setTimeout(function () {
        elToast.classList.remove("show");
      }, 900);
    }

    function renderSlide(i) {
      var s = slides[i] || {};
      toggleClass(elStage, "is-persona", !!(s && s.key === "persona"));
      var tagText = (s && s.tag != null) ? escapeHtml(s.tag) : "";
      var kickerHtml =
        "<div class='kicker fadeIn'>" +
        (tagText ? ("<span class='tag'><span aria-hidden='true'>‚ú¶</span> <b>" + tagText + "</b></span>") : "<span></span>") +
        "<span class='badge'>2025</span>" +
        "</div>";

      var titleHtml = "<h1 class='title fadeIn' style='animation-delay:60ms'>" + tpl(s.title || "") + "</h1>";
      var bodyHtml = s.body ? ("<p class='sub fadeIn' style='animation-delay:110ms'>" + tpl(s.body) + "</p>") : "";

      var statHtml = "";
      if (s.statLabel && s.statValue) {
        statHtml =
          "<div class='stat fadeIn' style='animation-delay:160ms'>" +
          "<div class='label'>" + escapeHtml(s.statLabel) + "</div>" +
          "<div class='value'>" + tpl(s.statValue) + "</div>" +
          "</div>";
      }

      var footHtml =
        "<div class='foot fadeIn' style='animation-delay:210ms'>" +
        "<div class='note'>" + tpl(s.note || "") + "</div>" +
        "<div class='cta' id='ctaBtn'>" + escapeHtml(s.cta || "Ti·∫øp") + "</div>" +
        "</div>";

      elContent.innerHTML = kickerHtml + "<div>" + titleHtml + bodyHtml + "</div>" + statHtml + footHtml;

      var ctaBtn = document.getElementById("ctaBtn");
      if (ctaBtn) {
        addEvt(ctaBtn, "click", function (e) {
          prevent(e);
          next();
        }, false);
      }
    }

    function resetTimer() {
      startedAt = Date.now();
      pausedAccum = 0;
      paused = false;
      pauseStartedAt = 0;
    }

    function setIndex(nextIdx, reason) {
      var newIdx = clamp(nextIdx, 0, slides.length - 1);
      if (newIdx === idx) {
        if (reason === "next" && idx === slides.length - 1) showToast("ƒê√£ t·ªõi slide cu·ªëi");
        if (reason === "prev" && idx === 0) showToast("ƒêang ·ªü slide ƒë·∫ßu");
        return;
      }
      idx = newIdx;
      resetTimer();
      renderSlide(idx);
    }

    function next(){ setIndex(idx + 1, "next"); }
    function prev(){ setIndex(idx - 1, "prev"); }

    function pause() {
      if (!HOLD_TO_PAUSE) return;
      if (paused) return;
      paused = true;
      pauseStartedAt = Date.now();
    }

    function resume() {
      if (!HOLD_TO_PAUSE) return;
      if (!paused) return;
      paused = false;
      pausedAccum += (Date.now() - pauseStartedAt);
      pauseStartedAt = 0;
    }

    function tick() {
      if (!segEls || !segEls.length || !segEls[idx]) {
        rafId = window.requestAnimationFrame(tick);
        return;
      }
      for (var i = 0; i < segEls.length; i++) {
        if (i < idx) segEls[i].style.width = "100%";
        else if (i > idx) segEls[i].style.width = "0%";
      }

      var now = Date.now();
      var effectiveNow = paused ? pauseStartedAt : now;
      var elapsed = effectiveNow - startedAt - pausedAccum;
      var p = clamp(elapsed / SLIDE_DURATION_MS, 0, 1);
      segEls[idx].style.width = (p * 100).toFixed(2) + "%";

      if (!paused && p >= 1) {
        if (idx < slides.length - 1) setIndex(idx + 1, "next");
      }

      rafId = window.requestAnimationFrame(tick);
    }

    // Tap left/right
    addEvt(elPrev, "click", function (e) { prevent(e); prev(); }, false);
    addEvt(elNext, "click", function (e) { prevent(e); next(); }, false);

    // Hold to pause
    function bindHold(el){
      addEvt(el, "touchstart", function(){ pause(); }, OPT_PASSIVE_TRUE);
      addEvt(el, "touchend", function(){ resume(); }, OPT_PASSIVE_TRUE);
      addEvt(el, "touchcancel", function(){ resume(); }, OPT_PASSIVE_TRUE);
      addEvt(el, "mousedown", function(){ pause(); }, false);
      addEvt(el, "mouseup", function(){ resume(); }, false);
      addEvt(el, "mouseleave", function(){ resume(); }, false);
    }
    bindHold(elStage);

    // Prevent double-tap zoom on iOS webviews
    var lastTouch = 0;
    addEvt(document, "touchend", function (e) {
      var now = Date.now();
      if (now - lastTouch <= 250) prevent(e);
      lastTouch = now;
    }, OPT_PASSIVE_FALSE);

    // Keyboard (debug)
    addEvt(document, "keydown", function (e) {
      e = e || window.event;
      if (e.key === "ArrowRight") next();
      if (e.key === "ArrowLeft") prev();
      if (e.key === " ") { paused ? resume() : pause(); }
    }, false);

    // Show JS errors in toast (helps Android webview debugging)
    window.onerror = function (msg, url, line, col) {
      try {
        showToast("L·ªói: " + String(msg || "Unknown") + " @" + String(line || 0) + ":" + String(col || 0));
      } catch (e) { /* ignore */ }
      return false;
    };

    renderSlide(idx);
    tick();
  })();
</script>
</body>
</html>

